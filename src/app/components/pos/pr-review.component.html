<div class="p-8 bg-gray-50 min-h-screen">
    <h1 class="text-4xl font-bold text-gray-800 mb-8">Pull Request Auto-Review</h1>

    <!-- Submit New PR -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Submit Pull Request</h2>
        <form (ngSubmit)="onSubmitPr()" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input [(ngModel)]="newPr.title" name="title" placeholder="PR Title"
                class="md:col-span-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                required />
            <input [(ngModel)]="newPr.branch" name="branch" placeholder="Branch Name"
                class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required />
            <input type="number" [(ngModel)]="newPr.lintScore" name="lintScore" placeholder="Lint Score (0-100)" min="0"
                max="100" class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                required />
            <div class="md:col-span-2">
                <label class="flex items-center space-x-2">
                    <input type="checkbox" [(ngModel)]="newPr.testsPassed" name="testsPassed"
                        class="w-4 h-4 text-blue-600 rounded" />
                    <span class="text-gray-700 font-medium">All Tests Passed</span>
                </label>
            </div>
            <textarea [(ngModel)]="newPr.description" name="description" placeholder="PR Description"
                class="md:col-span-2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                rows="3"></textarea>
            <button type="submit"
                class="md:col-span-2 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-semibold transition-colors">
                Submit PR
            </button>
        </form>
    </div>

    <!-- Tabs for PR Status -->
    <div class="flex space-x-4 mb-6">
        <button (click)="selectedTab = 'pending'" [class]="
        'px-6 py-2 rounded-lg font-semibold transition-colors ' +
        (selectedTab === 'pending'
          ? 'bg-yellow-600 text-white'
          : 'bg-white text-gray-700 border-2 border-yellow-600')
      ">
            Pending
        </button>
        <button (click)="selectedTab = 'approved'" [class]="
        'px-6 py-2 rounded-lg font-semibold transition-colors ' +
        (selectedTab === 'approved'
          ? 'bg-green-600 text-white'
          : 'bg-white text-gray-700 border-2 border-green-600')
      ">
            Approved
        </button>
        <button (click)="selectedTab = 'rejected'" [class]="
        'px-6 py-2 rounded-lg font-semibold transition-colors ' +
        (selectedTab === 'rejected'
          ? 'bg-red-600 text-white'
          : 'bg-white text-gray-700 border-2 border-red-600')
      ">
            Rejected
        </button>
    </div>

    <!-- Pull Requests List -->
    <div class="space-y-4">
        <div *ngFor="let pr of getFilteredPrs()" class="bg-white rounded-lg shadow-md p-6 border-l-4" [class]="
        pr.status === 'approved'
          ? 'border-l-green-500'
          : pr.status === 'rejected'
            ? 'border-l-red-500'
            : 'border-l-yellow-500'
      ">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-xl font-bold text-gray-800">{{ pr.title }}</h3>
                    <p class="text-sm text-gray-600">{{ pr.description }}</p>
                </div>
                <span [class]="
            'px-3 py-1 rounded-full text-white font-semibold ' +
            (pr.status === 'approved'
              ? 'bg-green-500'
              : pr.status === 'rejected'
                ? 'bg-red-500'
                : 'bg-yellow-500')
          ">
                    {{ pr.status | titlecase }}
                </span>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm">
                <div>
                    <p class="text-gray-600">Branch</p>
                    <p class="font-semibold text-gray-800">{{ pr.branch }}</p>
                </div>
                <div>
                    <p class="text-gray-600">Author</p>
                    <p class="font-semibold text-gray-800">{{ pr.author }}</p>
                </div>
                <div>
                    <p class="text-gray-600">Lint Score</p>
                    <p [class]="
              'font-semibold ' +
              (pr.lintScore >= 90 ? 'text-green-600' : pr.lintScore >= 75 ? 'text-yellow-600' : 'text-red-600')
            ">
                        {{ pr.lintScore }}/100
                    </p>
                </div>
                <div>
                    <p class="text-gray-600">Tests</p>
                    <p [class]="'font-semibold ' + (pr.testsPassed ? 'text-green-600' : 'text-red-600')">
                        {{ pr.testsPassed ? '✓ Passing' : '✗ Failing' }}
                    </p>
                </div>
            </div>

            <!-- Code Review Comments -->
            <div class="mb-4 bg-gray-50 rounded p-4">
                <p class="text-sm font-semibold text-gray-700 mb-2">Auto-Review Comments:</p>
                <ul class="space-y-1">
                    <li *ngFor="let comment of pr.codeReviewComments" class="text-sm text-gray-700">
                        • {{ comment }}
                    </li>
                </ul>
            </div>

            <!-- Manual Review (for pending PRs) -->
            <div *ngIf="pr.status === 'pending'" class="border-t pt-4 mt-4">
                <p class="text-sm font-semibold text-gray-700 mb-3">Manual Review:</p>
                <div class="space-y-3">
                    <textarea [(ngModel)]="manualReviewComments[pr.id]" placeholder="Enter review comment..."
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        rows="2"></textarea>
                    <div class="flex space-x-2">
                        <button (click)="onManualReview(pr.id, true)"
                            class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-semibold transition-colors">
                            Approve
                        </button>
                        <button (click)="onManualReview(pr.id, false)"
                            class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-semibold transition-colors">
                            Reject
                        </button>
                    </div>
                </div>
            </div>

            <!-- Metadata -->
            <div class="text-xs text-gray-500 mt-4">
                Created: {{ pr.createdAt | date: 'medium' }} | Updated: {{ pr.updatedAt | date: 'medium' }}
            </div>
        </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="getFilteredPrs().length === 0" class="text-center py-12">
        <p class="text-gray-500 text-lg">No pull requests in this category</p>
    </div>
</div>